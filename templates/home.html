<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='home_style.css') }}">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar for large screens -->
            <nav class="col-lg-2 d-none d-lg-block sidebar">
                <div class="sidebar-content">

                    <h2 class="sidebar-title">Barangay San Mateo Health Center Medicine Cabinet</h2>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" id="inventory-link" href="javascript:void(0);" onclick="loadContent('inventory', 'inventory-link')">
                                <i class='bx bx-box'></i>
                                Inventory
                            </a>
                        </li> 
                        <li class="nav-item">
                            <a class="nav-link" id="doorlogs-link" href="javascript:void(0);" onclick="loadContent('doorlogs', 'doorlogs-link')">
                                <i class='bx bx-door-open'></i>
                                Door Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="notification-link" href="javascript:void(0);" onclick="loadContent('notification', 'notification-link')">
                                <i class='bx bx-bell'></i>
                                Notification
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="accounts-link" href="javascript:void(0);" onclick="loadContent('accounts', 'accounts-link')">
                                <i class='bx bx-cog'></i>
                                Accounts
                            </a>
                        </li>
                        <li class="nav-item sidebar-footer">
                            <a class="nav-link text-danger" href="{{ url_for('logout') }}">
                                <i class='bx bx-log-out'></i>
                                Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Offcanvas Sidebar for medium and smaller screens -->
            <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="offcanvasSidebar" aria-labelledby="offcanvasSidebarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasSidebarLabel">Welcome, {{ user }}!</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" id="offcanvas-inventory-link" href="javascript:void(0);" onclick="loadContent('inventory', 'inventory-link', 'offcanvas-inventory-link')">
                                <i class='bx bx-box'></i>
                                Inventory
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="offcanvas-notification-link" href="javascript:void(0);" onclick="loadContent('notification', 'notification-link', 'offcanvas-notification-link')">
                                <i class='bx bx-bell'></i>
                                Notification
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="offcanvas-accounts-link" href="javascript:void(0);" onclick="loadContent('accounts', 'accounts-link', 'offcanvas-accounts-link')">
                                <i class='bx bx-cog'></i>
                                Accounts
                            </a>
                        </li>
                        <li class="nav-item sidebar-footer">
                            <a class="nav-link text-danger" href="{{ url_for('logout') }}">
                                <i class='bx bx-log-out'></i>
                                Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Main content area -->
            <main class="col-lg-10 ms-sm-auto col-lg-10 px-md-4">
                <header class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <div class="d-lg-none">
                        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
                            <i class='bx bx-menu navbar-toggler-icon'></i>
                        </button>
                    </div>
               
                </header>
                
                <!-- Load the default content here -->
                <div id="main-content">
                    {% include content %}
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='idleLogout.js') }}"></script>
    <script>
        function loadContent(section, sidebarLinkId, offcanvasLinkId) {
            // Fetch the new content
            fetch(`/${section}`)
                .then(response => response.text())
                .then(html => {
                    // Load the new content into the main content area
                    document.getElementById('main-content').innerHTML = html;

                    // Remove the "active" class from all sidebar links
                    const sidebarLinks = document.querySelectorAll('.sidebar .nav-link');
                    sidebarLinks.forEach(link => link.classList.remove('active'));

                    // Remove the "active" class from all offcanvas links
                    const offcanvasLinks = document.querySelectorAll('.offcanvas-body .nav-link');
                    offcanvasLinks.forEach(link => link.classList.remove('active'));

                    // Add the "active" class to the clicked sidebar link
                    if (sidebarLinkId) {
                        document.getElementById(sidebarLinkId).classList.add('active');
                    }

                    // Add the "active" class to the clicked offcanvas link
                    if (offcanvasLinkId) {
                        document.getElementById(offcanvasLinkId).classList.add('active');
                    }
                })
                .catch(error => console.error('Error loading content:', error));
        }
        // Automatically load Inventory when the page is first loaded
        document.addEventListener("DOMContentLoaded", function() {
            loadContent('inventory', 'inventory-link', 'offcanvas-inventory-link');
        });
        // Event Listener for Window Resize
        function checkScreenSizeAndCloseOffcanvas() {
            const offcanvasSidebar = document.getElementById('offcanvasSidebar');
            const bsOffcanvas = bootstrap.Offcanvas.getInstance(offcanvasSidebar);
            //Function when the screen is currently on smally
            if (window.innerWidth >= 992) { // 992px is the breakpoint for lg (large screens)
                if (bsOffcanvas && bsOffcanvas._isShown) {
                    bsOffcanvas.hide(); // Close the offcanvas if it's shown
                }
            }
        }
        // Attach the resize event listener
        window.addEventListener('resize', checkScreenSizeAndCloseOffcanvas);
    </script>
</body>
</html>
